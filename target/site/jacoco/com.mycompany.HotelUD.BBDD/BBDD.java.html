<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BBDD.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">HotelUD</a> &gt; <a href="index.source.html" class="el_package">com.mycompany.HotelUD.BBDD</a> &gt; <span class="el_source">BBDD.java</span></div><h1>BBDD.java</h1><pre class="source lang-java linenums">package com.mycompany.HotelUD.BBDD;

import java.awt.print.Printable;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.logging.Level;

import com.mycompany.HotelUD.classes.Dependient;
import com.mycompany.HotelUD.classes.Room;
import com.mycompany.HotelUD.classes.User;
import com.mycompany.HotelUD.classes.Worker;

public class BBDD {
	public static Connection connection;
	public static PreparedStatement statement;
	
//	public static Connection initBD(String nombreBD) {
//		try {
//			Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
//			connection = DriverManager.getConnection(url,usuario,password);
//			System.out.println(&quot;Conexion realizada&quot;);
//			return connection;
//		} catch (ClassNotFoundException | SQLException e) {
//			return null;
//		}
//	}
<span class="nc" id="L32">	public BBDD() {</span>
			try {
<span class="nc" id="L34">				connection = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/Hotel?useUnicode=true&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC&quot;,&quot;root&quot;,&quot;1234&quot;);</span>
<span class="nc" id="L35">				System.out.println(&quot;Conexion realizada&quot;);</span>
<span class="nc" id="L36">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L38">				e.printStackTrace();</span>
			}

<span class="nc" id="L41">	}</span>
	
	public static void conectionWorkers(String nombreBD) {
		try {
<span class="nc" id="L45">			statement = (PreparedStatement) connection.createStatement();</span>
			try {
<span class="nc" id="L47">				statement.executeUpdate(&quot;create table &quot; + nombreBD</span>
<span class="nc" id="L48">						+ &quot; (counter integer primary key autoincrement, name varchar, dni varchar, gender varchar, age integer )&quot;);</span>
<span class="nc" id="L49">			} catch (SQLException e) {</span>
<span class="nc" id="L50">				System.out.println(&quot;Ya esta creada&quot;);</span>
			}
<span class="nc" id="L52">		} catch (SQLException e) {</span>
<span class="nc" id="L53">			System.out.println(&quot;Error&quot;);</span>
		}
<span class="nc" id="L55">	}</span>
	
	public static void conectionUsers(String nombreBD) {
		try {
<span class="nc" id="L59">			statement = (PreparedStatement) connection.createStatement();</span>
			try {
<span class="nc" id="L61">				statement.executeUpdate(&quot;create table &quot; + nombreBD</span>
<span class="nc" id="L62">						+ &quot; (counter integer primary key autoincrement, name varchar, surname varchar, dni varchar, gender varchar, age integer, bankCount varchar)&quot;);</span>
<span class="nc" id="L63">			} catch (SQLException e) {</span>
<span class="nc" id="L64">				System.out.println(&quot;Ya esta creada&quot;);</span>
			}
<span class="nc" id="L66">		} catch (SQLException e) {</span>
<span class="nc" id="L67">			System.out.println(&quot;Error&quot;);</span>
		}
<span class="nc" id="L69">	}</span>
	
	public static void conectionRoom(String nombreBD) {
		try {
<span class="nc" id="L73">			statement = (PreparedStatement) connection.createStatement();</span>
			try {
<span class="nc" id="L75">				statement.executeUpdate(&quot;create table &quot; + nombreBD</span>
<span class="nc" id="L76">						+ &quot; (numberDoor integer primary key autoincrement, type varchar, surface integer, floor integer)&quot;);</span>
<span class="nc" id="L77">			} catch (SQLException e) {</span>
<span class="nc" id="L78">				System.out.println(&quot;Ya esta creada&quot;);</span>
			}
<span class="nc" id="L80">		} catch (SQLException e) {</span>
<span class="nc" id="L81">			System.out.println(&quot;Error&quot;);</span>
		}
<span class="nc" id="L83">	}</span>
	
	public Connection getConection() {
<span class="nc" id="L86">		return connection;</span>
	}
	
	public static void addWorker(Worker worker) {
		try {
<span class="nc" id="L91">			statement = connection.prepareStatement(&quot;INSERT INTO workers (counter,name,dni,gender,age) VALUES ( ?, ?, ?, ?, ?)&quot;);</span>
<span class="nc" id="L92">			Statement st= connection.createStatement();</span>
<span class="nc" id="L93">			statement.setLong(1, 0);</span>
<span class="nc" id="L94">			statement.setString(2, worker.getName());</span>
<span class="nc" id="L95">			statement.setString(3, worker.getDni());</span>
<span class="nc" id="L96">			statement.setString(4, worker.getGender());</span>
<span class="nc" id="L97">			statement.setLong(5, worker.getAge());</span>
			
<span class="nc" id="L99">			statement.executeUpdate();</span>
<span class="nc" id="L100">			statement.close();</span>
<span class="nc" id="L101">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L103">			e.printStackTrace();</span>
		}finally {
<span class="nc bnc" id="L105" title="All 2 branches missed.">			if (connection!= null) {</span>
				try {
<span class="nc" id="L107">					connection.close();</span>
<span class="nc" id="L108">				} catch (SQLException e) {</span>
					// TODO Auto-generated catch block
<span class="nc" id="L110">					e.printStackTrace();</span>
				}
			}
		}
<span class="nc" id="L114">	}</span>
	
	public static void addUsers(User user) {
		try {
<span class="nc" id="L118">			statement = connection.prepareStatement(&quot;INSERT INTO users (counter,name,password,dni,gender,age,bankCount) VALUES ( ?, ?, ?, ?, ?, ?, ?)&quot;);</span>
<span class="nc" id="L119">			Statement st= connection.createStatement();</span>
<span class="nc" id="L120">			statement.setLong(1, 0);</span>
<span class="nc" id="L121">			statement.setString(2, user.getName());</span>
<span class="nc" id="L122">			statement.setString(3, user.getPassword());</span>
<span class="nc" id="L123">			statement.setString(4, user.getDni());</span>
<span class="nc" id="L124">			statement.setString(5, user.getGender());</span>
<span class="nc" id="L125">			statement.setLong(6, user.getAge());</span>
<span class="nc" id="L126">			statement.setString(7, user.getBankCount());</span>
			
<span class="nc" id="L128">			statement.executeUpdate();</span>
<span class="nc" id="L129">			statement.close();</span>
<span class="nc" id="L130">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L132">			e.printStackTrace();</span>
		}finally {
<span class="nc bnc" id="L134" title="All 2 branches missed.">			if (connection!= null) {</span>
				try {
<span class="nc" id="L136">					connection.close();</span>
<span class="nc" id="L137">				} catch (SQLException e) {</span>
					// TODO Auto-generated catch block
<span class="nc" id="L139">					e.printStackTrace();</span>
				}
			}
		}
<span class="nc" id="L143">	}</span>
	
	public static void addRoom(Room room) {
		try {
<span class="nc" id="L147">			statement = connection.prepareStatement(&quot;INSERT INTO room (numberDoor,type,surface,floor) VALUES ( ?, ?, ?, ?)&quot;);</span>
<span class="nc" id="L148">			Statement st= connection.createStatement();</span>
<span class="nc" id="L149">			statement.setLong(1, 0);</span>
<span class="nc" id="L150">			statement.setString(2, room.getType());</span>
<span class="nc" id="L151">			statement.setLong(3, room.getSurface());</span>
<span class="nc" id="L152">			statement.setLong(4, room.getFloor());</span>
			
<span class="nc" id="L154">			statement.executeUpdate();</span>
<span class="nc" id="L155">			statement.close();</span>
<span class="nc" id="L156">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L158">			e.printStackTrace();</span>
		}finally {
<span class="nc bnc" id="L160" title="All 2 branches missed.">			if (connection!= null) {</span>
				try {
<span class="nc" id="L162">					connection.close();</span>
<span class="nc" id="L163">				} catch (SQLException e) {</span>
					// TODO Auto-generated catch block
<span class="nc" id="L165">					e.printStackTrace();</span>
				}
			}
		}
<span class="nc" id="L169">	}</span>
	
	public static ArrayList&lt;Worker&gt; getWorkers() {
<span class="nc" id="L172">		ArrayList&lt;Worker&gt; result = new ArrayList&lt;Worker&gt;();</span>
<span class="nc" id="L173">		String consult = &quot;SELECT * FROM workers&quot;;</span>
		try {
<span class="nc" id="L175">			ResultSet rs = connection.createStatement().executeQuery(consult);</span>
<span class="nc bnc" id="L176" title="All 2 branches missed.">			while(rs.next()) {</span>
<span class="nc" id="L177">				Worker worker2 = new Worker();</span>
<span class="nc" id="L178">				worker2.setCounter(rs.getInt(1));</span>
<span class="nc" id="L179">				worker2.setName(rs.getString(2));</span>
<span class="nc" id="L180">				worker2.setDni(rs.getString(3));</span>
<span class="nc" id="L181">				worker2.setGender(rs.getString(4));</span>
<span class="nc" id="L182">				worker2.setAge(rs.getInt(5));</span>
<span class="nc" id="L183">				result.add(worker2);</span>
			}
<span class="nc" id="L185">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L187">			e.printStackTrace();</span>
		}
<span class="nc" id="L189">		return result;</span>

	}
	public static ArrayList&lt;User&gt; getUsers() {
<span class="nc" id="L193">		ArrayList&lt;User&gt; result = new ArrayList&lt;User&gt;();</span>
<span class="nc" id="L194">		String consult = &quot;SELECT * FROM users&quot;;</span>
		try {
<span class="nc" id="L196">			ResultSet rs = connection.createStatement().executeQuery(consult);</span>
<span class="nc bnc" id="L197" title="All 2 branches missed.">			while(rs.next()) {</span>
<span class="nc" id="L198">				User user2 = new User();</span>
<span class="nc" id="L199">				user2.setCounter(rs.getInt(1));</span>
<span class="nc" id="L200">				user2.setName(rs.getString(2));</span>
<span class="nc" id="L201">				user2.setPassword(rs.getString(3));</span>
<span class="nc" id="L202">				user2.setDni(rs.getString(4));</span>
<span class="nc" id="L203">				user2.setGender(rs.getString(5));</span>
<span class="nc" id="L204">				user2.setAge(rs.getInt(6));</span>
<span class="nc" id="L205">				user2.setBankCount(rs.getString(7));</span>
<span class="nc" id="L206">				result.add(user2);</span>
			}
<span class="nc" id="L208">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L210">			e.printStackTrace();</span>
		}
<span class="nc" id="L212">		return result;</span>

	}
	
	public static ArrayList&lt;Room&gt; getRooms() {
<span class="nc" id="L217">		ArrayList&lt;Room&gt; result = new ArrayList&lt;Room&gt;();</span>
<span class="nc" id="L218">		String consult = &quot;SELECT * FROM room&quot;;</span>
		try {
<span class="nc" id="L220">			ResultSet rs = connection.createStatement().executeQuery(consult);</span>
<span class="nc bnc" id="L221" title="All 2 branches missed.">			while(rs.next()) {</span>
<span class="nc" id="L222">				Room room2 = new Room();</span>
<span class="nc" id="L223">				room2.setNumberDoor(rs.getInt(1));</span>
<span class="nc" id="L224">				room2.setType(rs.getString(2));</span>
<span class="nc" id="L225">				room2.setSurface(rs.getInt(3));</span>
<span class="nc" id="L226">				room2.setFloor(rs.getInt(4));</span>
<span class="nc" id="L227">				result.add(room2);</span>
			}
<span class="nc" id="L229">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L231">			e.printStackTrace();</span>
		}
<span class="nc" id="L233">		return result;</span>

	}
	
<span class="nc" id="L237">	public static void addDependient(Dependient dependient) {</span>
		try {
			statement = connection.prepareStatement(&quot;INSERT INTO dependients (counter,name,dni,password,gender,position,description,bankAccount) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?)&quot;);
			Statement st= connection.createStatement();
			statement.setLong(1, 0);
			statement.setString(2, dependient.getName());
			statement.setString(3, dependient.getDni());
			statement.setString(4, dependient.getPassword());
			statement.setString(5, dependient.getGender());
			statement.setString(6, dependient.getPosition());
			statement.setString(7, dependient.getDescription());
			statement.setString(8, dependient.getBankAccount());
			
			statement.executeUpdate();
			statement.close();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}finally {
			if (connection!= null) {
				try {
					connection.close();
				} catch (SQLException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
			}
		}
	}
<span class="nc" id="L266">	public static ArrayList&lt;Dependient&gt; getDependients() {</span>
		ArrayList&lt;Dependient&gt; result = new ArrayList&lt;Dependient&gt;();
		String consult = &quot;SELECT * FROM dependients&quot;;
		try {
			ResultSet rs = connection.createStatement().executeQuery(consult);
			while(rs.next()) {
				Dependient dependient2 = new Dependient();
				dependient2.setCounter(rs.getInt(1));
				dependient2.setName(rs.getString(2));
				dependient2.setDni(rs.getString(3));
				dependient2.setPassword(rs.getString(4));
				dependient2.setGender(rs.getString(5));
				dependient2.setPosition(rs.getString(6));
				dependient2.setDescription(rs.getString(7));
				dependient2.setBankAccount(rs.getString(8));
				result.add(dependient2);
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return result;

	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>